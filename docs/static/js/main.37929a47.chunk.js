(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{158:function(e,t,a){e.exports={header:"Controller_header__3vMNd"}},169:function(e,t,a){e.exports={overflow:"PersonalTasks_overflow__3LecE"}},170:function(e,t,a){e.exports={avator:"PersonalInfo_avator__1rp4U"}},193:function(e,t,a){e.exports=a(399)},198:function(e,t,a){},399:function(e,t,a){"use strict";a.r(t);var n,r,c=a(1),l=a.n(c),s=a(48),u=a.n(s),o=(a(198),a(199),a(12)),i=a(8),m=a.n(i),d=a(2),_=a.n(d);!function(e){e.SET_URL="SET_URL",e.SET_PID="SET_PID",e.SET_MID="SET_MID",e.SET_MILESTONES="SET_MILESTONES",e.SET_CUSTOM_EID="SET_CUSTOM_EID",e.SET_CUSTOM_RID="SET_CUSTOM_RID",e.SET_CUSTOM_ATTRS="SET_CUSTOM_ATTRS",e.SET_BIZ_DAYS="SET_BIZ_DAYS",e.ADD_BIZ_DAY="ADD_BIZ_DAY",e.REMOVE_BIZ_DAY="REMOVE_BIZ_DAY",e.SET_TASKS="SET_TASKS",e.SET_TASK_STATUS="SET_TASK_STATUS",e.SET_CUSTOM_VALUE_MAP="SET_CUSTOM_VALUE_MAP",e.SET_REJECT_TASK_STATUS_IDS="SET_REJECT_TASK_STATUS_IDS",e.ADD_REJECT_TASK_STATUS_ID="ADD_REJECT_TASK_STATUS",e.REMOVE_REJECT_TASK_STATUS_ID="REMOVE_REJECT_TASK_STATUS",e.OPEN_CONTROLLER="OPEN_CONTROLLER",e.CLOSE_CONTROLLER="CLOSE_CONTROLLER",e.UPDATE_DATA="UPDATE_DATA"}(n||(n={})),function(e){e.URL="taiga_url",e.PID="taiga_pid",e.MID="taiga_mid",e.CUSTOM_EID="taiga_custom_eid",e.CUSTOM_RID="taiga_custom_rid",e.BIZ_DAYS="taiga_biz_days",e.REJECT_TASK_STATUS_IDS="reject_task_status_ids"}(r||(r={}));var E=function(e){return localStorage.getItem(e)||""},f=function(e,t){return t?E("".concat(t,"/").concat(e)):""},p=function(e,t){localStorage.setItem(e,t)},b=function(e,t,a){t&&p("".concat(t,"/").concat(e),a)},S=function(){var e=E(r.URL),t=E(r.PID),a=E(r.MID),n=f(r.CUSTOM_EID,t),c=f(r.CUSTOM_RID,t),l=f(r.BIZ_DAYS,a),s=m.a.compact(l.split(",")).sort(),u=m.a.compact(f(r.REJECT_TASK_STATUS_IDS,t).split(",")),o=!(e&&t&&a&&n&&c);return{url:e,pid:t,mid:a,custom_eid:n,custom_rid:c,custom_attrs:[],biz_days:s,milestones:[],tasks:[],task_status:[],custom_value_map:new WeakMap,reject_task_status_ids:u,updated_time:0,isOpen:o}},T=a(38),O=a(11),v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.SET_URL:var a=t.payload.url;return p(r.URL,a),Object(O.a)({},e,{url:a});case n.SET_PID:var c=t.payload.pid;return p(r.PID,c),Object(O.a)({},e,{pid:c,mid:"",custom_eid:f(r.CUSTOM_EID,c),custom_rid:f(r.CUSTOM_RID,c),custom_attrs:[],milestones:[],custom_value_map:new WeakMap});case n.SET_MID:var l=t.payload.mid;return p(r.MID,l),Object(O.a)({},e,{mid:l,tasks:[],biz_days:m.a.compact(f(r.BIZ_DAYS,l).split(",")).sort()});case n.SET_MILESTONES:var s=t.payload.milestones;return Object(O.a)({},e,{milestones:s});case n.SET_CUSTOM_EID:var u=t.payload.custom_eid;return b(r.CUSTOM_EID,e.pid,u),Object(O.a)({},e,{custom_eid:u});case n.SET_CUSTOM_ATTRS:var o=t.payload.custom_attrs;return Object(O.a)({},e,{custom_attrs:o});case n.SET_CUSTOM_RID:var i=t.payload.custom_rid;return b(r.CUSTOM_RID,e.pid,i),Object(O.a)({},e,{custom_rid:i});case n.SET_BIZ_DAYS:var d=t.payload.biz_days;return b(r.BIZ_DAYS,e.mid,d.join(",")),Object(O.a)({},e,{biz_days:d});case n.ADD_BIZ_DAY:var _=t.payload.biz_day,E=m.a.chain([].concat(Object(T.a)(e.biz_days),[_])).uniq().sort().value();return b(r.BIZ_DAYS,e.mid,E.join(",")),Object(O.a)({},e,{biz_days:E});case n.REMOVE_BIZ_DAY:var v=t.payload.biz_day,j=m.a.reject(Object(T.a)(e.biz_days),function(e){return e===v});return b(r.BIZ_DAYS,e.mid,j.join(",")),Object(O.a)({},e,{biz_days:j});case n.SET_TASKS:var g=t.payload.tasks;return Object(O.a)({},e,{tasks:g});case n.SET_TASK_STATUS:var y=t.payload.task_status;return Object(O.a)({},e,{task_status:y});case n.SET_CUSTOM_VALUE_MAP:var k=t.payload.custom_value_map;return Object(O.a)({},e,{custom_value_map:k});case n.SET_REJECT_TASK_STATUS_IDS:var h=t.payload.reject_task_status_ids;return b(r.REJECT_TASK_STATUS_IDS,e.pid,h.join(",")),Object(O.a)({},e,{reject_task_status_ids:h});case n.ADD_REJECT_TASK_STATUS_ID:var C=t.payload.reject_task_status_id,D=m.a.chain([].concat(Object(T.a)(e.reject_task_status_ids),[C])).compact().uniq().value();return b(r.REJECT_TASK_STATUS_IDS,e.pid,D.join(",")),Object(O.a)({},e,{reject_task_status_ids:D});case n.REMOVE_REJECT_TASK_STATUS_ID:var A=t.payload.reject_task_status_id,x=m.a.reject(Object(T.a)(e.reject_task_status_ids),function(e){return e===A});return b(r.REJECT_TASK_STATUS_IDS,e.pid,x.join(",")),Object(O.a)({},e,{reject_task_status_ids:x});case n.OPEN_CONTROLLER:return Object(O.a)({},e,{isOpen:!0});case n.CLOSE_CONTROLLER:return Object(O.a)({},e,{isOpen:!1});case n.UPDATE_DATA:return Object(O.a)({},e,{updated_time:Date.now()});default:return e}},j=function(e){return"".concat(e.replace(/[\xa5\/]$/,""),"/api/v1")},g=S(),y=Object(c.createContext)({state:g,setUrl:function(e){},setPid:function(e){},setMid:function(e){},setMilestones:function(e){},setCustomEid:function(e){},setCustomRid:function(e){},setCustomAttrs:function(e){},setBizDays:function(e){},addBizDay:function(e){},removeBizDay:function(e){},setTasks:function(e){},setTaskStatus:function(e){},setCustomValueMap:function(e){},toggeRejectTaskStatus:function(e,t){},openController:function(){},closeController:function(){},updateData:function(){}}),k=function(e){var t=e.children,a=Object(c.useReducer)(v,g),r=Object(o.a)(a,2),s=r[0],u=r[1],i={state:s,setUrl:Object(c.useCallback)(function(e){u({type:n.SET_URL,payload:{url:e}})},[u]),setPid:Object(c.useCallback)(function(e){u({type:n.SET_PID,payload:{pid:e}})},[u]),setMid:Object(c.useCallback)(function(e){u({type:n.SET_MID,payload:{mid:e}})},[u]),setMilestones:Object(c.useCallback)(function(e){u({type:n.SET_MILESTONES,payload:{milestones:e}})},[u]),setCustomEid:Object(c.useCallback)(function(e){u({type:n.SET_CUSTOM_EID,payload:{custom_eid:e}})},[u]),setCustomRid:Object(c.useCallback)(function(e){u({type:n.SET_CUSTOM_RID,payload:{custom_rid:e}})},[u]),setCustomAttrs:Object(c.useCallback)(function(e){u({type:n.SET_CUSTOM_ATTRS,payload:{custom_attrs:e}})},[u]),setBizDays:Object(c.useCallback)(function(e){u({type:n.SET_BIZ_DAYS,payload:{biz_days:e}})},[u]),addBizDay:Object(c.useCallback)(function(e){u({type:n.ADD_BIZ_DAY,payload:{biz_day:e}})},[u]),removeBizDay:Object(c.useCallback)(function(e){u({type:n.REMOVE_BIZ_DAY,payload:{biz_day:e}})},[u]),setTasks:Object(c.useCallback)(function(e){u({type:n.SET_TASKS,payload:{tasks:e}})},[u]),setTaskStatus:Object(c.useCallback)(function(e){u({type:n.SET_TASK_STATUS,payload:{task_status:e}})},[u]),setCustomValueMap:Object(c.useCallback)(function(e){u({type:n.SET_CUSTOM_VALUE_MAP,payload:{custom_value_map:e}})},[u]),toggeRejectTaskStatus:Object(c.useCallback)(function(e,t){var a=t?n.ADD_REJECT_TASK_STATUS_ID:n.REMOVE_REJECT_TASK_STATUS_ID;u({type:a,payload:{reject_task_status_id:e}})},[u]),openController:Object(c.useCallback)(function(){u({type:n.OPEN_CONTROLLER})},[u]),closeController:Object(c.useCallback)(function(){u({type:n.CLOSE_CONTROLLER})},[u]),updateData:Object(c.useCallback)(function(){u({type:n.UPDATE_DATA})},[u])};return l.a.createElement(y.Provider,{value:i},t)},h=a(405),C=a(406),D=a(409),A=a(410),x=a(411),I=a(400),N=a(401),U=a(402),M=a(412),R=a(18),w=a(15),z=a(14),L=a.n(z),B=a(21),Y=a(23),P=a.n(Y),K=function(){var e=Object(c.useContext)(y),t=e.state,a=t.url,n=t.pid,r=e.setPid,s=Object(c.useState)([]),u=Object(o.a)(s,2),i=u[0],m=u[1],d=Object(c.useCallback)(function(e){var t=e.target.value;t&&r(t)},[r]);return Object(c.useEffect)(function(){a&&Object(B.a)(L.a.mark(function e(){var t,n;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get("".concat(j(a),"/projects"));case 2:t=e.sent,n=t.data,m(n);case 5:case"end":return e.stop()}},e,this)}))()},[a,m]),l.a.createElement(I.a,{className:"col"},l.a.createElement(N.a,{addonType:"prepend"},"Project"),l.a.createElement(U.a,{value:n,type:"select",onChange:d},l.a.createElement("option",{value:""}," --- "),i.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)})))},J=function(){var e=Object(c.useContext)(y),t=e.state,a=t.url,n=t.pid,r=t.mid,s=t.updated_time,u=t.reject_task_status_ids,i=e.setMid,d=e.setMilestones,_=e.setTasks,E=Object(c.useState)([]),f=Object(o.a)(E,2),p=f[0],b=f[1],S=Object(c.useCallback)(function(e){var t=e.target.value;t&&i(t)},[i,p]);return Object(c.useEffect)(function(){a&&n&&Object(B.a)(L.a.mark(function e(){var t,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get("".concat(j(a),"/milestones"),{params:{project:n}});case 2:t=e.sent,r=t.data,b(r),d(r);case 6:case"end":return e.stop()}},e,this)}))()},[a,n]),Object(c.useEffect)(function(){a&&r&&Object(B.a)(L.a.mark(function e(){var t,n,c;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get("".concat(j(a),"/tasks"),{headers:{"x-disable-pagination":!0},params:{milestone:r}});case 2:t=e.sent,n=t.data,c=n.filter(function(e){return!m.a.includes(u,String(e.status))}),_(c);case 6:case"end":return e.stop()}},e,this)}))()},[a,r,s,u]),l.a.createElement(I.a,{className:"col"},l.a.createElement(N.a,{addonType:"prepend"},"Sprint"),l.a.createElement(U.a,{type:"select",value:r,onChange:S},l.a.createElement("option",{value:""}," --- "),p.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)})))},V=function(){var e=Object(c.useContext)(y),t=e.state,a=t.url,n=t.pid,r=t.custom_eid,s=t.custom_rid,u=t.tasks,i=e.setCustomEid,m=e.setCustomRid,d=e.setCustomAttrs,_=e.setCustomValueMap,E=Object(c.useState)([]),f=Object(o.a)(E,2),p=f[0],b=f[1],S=Object(c.useCallback)(function(e){var t=e.target.value;if(t)switch(e.target.name){case"eid":i(t);break;case"rid":m(t)}},[i,m]);return Object(c.useEffect)(function(){a&&n&&Object(B.a)(L.a.mark(function e(){var t,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get("".concat(j(a),"/task-custom-attributes"),{params:{project:n}});case 2:t=e.sent,r=t.data,b(r),d(r);case 6:case"end":return e.stop()}},e,this)}))()},[a,n,b,d]),Object(c.useEffect)(function(){a&&u.length&&r&&s&&Object(B.a)(L.a.mark(function e(){var t;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=WeakMap,e.next=3,Promise.all(u.map(function(){var e=Object(B.a)(L.a.mark(function e(t){var n,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get("".concat(j(a),"/tasks/custom-attributes-values/").concat(t.id));case 2:return n=e.sent,r=n.data,e.abrupt("return",[t,r]);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 3:e.t1=e.sent,t=new e.t0(e.t1),_(t);case 6:case"end":return e.stop()}},e,this)}))()},[a,u,r,s,_]),l.a.createElement("div",{className:"row"},l.a.createElement(I.a,{className:"col"},l.a.createElement(N.a,{addonType:"prepend"},"Estimate"),l.a.createElement(U.a,{value:r,name:"eid",type:"select",onChange:S},l.a.createElement("option",{value:""}," --- "),p.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)}))),l.a.createElement(I.a,{className:"col"},l.a.createElement(N.a,{addonType:"prepend"},"Result"),l.a.createElement(U.a,{value:s,name:"rid",type:"select",onChange:S},l.a.createElement("option",null," --- "),p.map(function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},Z=a(403),F=a(404),W=a(418),G=a(407),q=a(17),$=a.n(q),H=a(71),Q=a.n(H),X=function(e,t){return-1===t?"":0===t?"Planning":"Day ".concat(t)},ee=function(e,t){return t.find(function(t){return String(t.id)===e})},te=function(e){return{"text-danger":0===e,"text-info":6===e}},ae=function(e){var t=e.item,a=e.biz_days,n=e.idx;if(!t)return l.a.createElement("td",null,l.a.createElement("br",null));var r=Object(c.useContext)(y),s=r.addBizDay,u=r.removeBizDay,o=t.format("YYYY-MM-DD"),i=Object(c.useCallback)(function(e){var t=e.target.value;e.target.checked?s(t):u(t)},[s,u]),d=o===a[0],E="biz-day-".concat(o);return l.a.createElement(l.a.Fragment,null,l.a.createElement("td",{className:_()(te(n),{"table-info":d}),id:E},Q.a.isWeekDay(t)?l.a.createElement(Z.a,{check:!0,inline:!0},l.a.createElement(F.a,{check:!0},l.a.createElement(U.a,{onChange:i,disabled:Q.a.isWeekendDay(t),value:o,type:"checkbox",checked:m.a.includes(a,o),className:"form-check-input"}),o)):l.a.createElement("span",null,o)),m.a.includes(a,o)?l.a.createElement(W.a,{target:E},function(e,t){var a=t.indexOf(e);return X(0,a)}(o,a)):null)},ne=function(){var e=Object(c.useContext)(y),t=e.state,a=t.mid,n=t.milestones,r=t.biz_days,s=e.setBizDays,u=Object(c.useState)([]),i=Object(o.a)(u,2),d=i[0],E=i[1];if(Object(c.useEffect)(function(){var e=ee(a,n);if(e){var t=function(e){var t=$()(e.estimated_start).local(),a=$()(e.estimated_finish).local().diff(t,"days");return m.a.times(a).map(function(e){return t.clone().add(e,"days")})}(e);E(t),r.length<=1&&s(t.filter(function(e){return Q.a.isWeekDay(e)}).map(function(e){return e.format("YYYY-MM-DD")}))}},[a,n,r]),0===d.length)return null;var f=m.a.chunk([].concat(Object(T.a)(m.a.times(d[0].day(),function(){return null})),Object(T.a)(d)),7);return l.a.createElement(h.a,null,l.a.createElement(C.a,null,"Business Days"),l.a.createElement(G.a,{bordered:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,$.a.weekdays().map(function(e,t){return l.a.createElement("th",{key:t,className:_()("text-center",te(t))},e)}))),l.a.createElement("tbody",null,f.map(function(e,t){return l.a.createElement("tr",{key:t},e.map(function(e,t){return l.a.createElement(ae,{idx:t,key:t,item:e,biz_days:r})}))}))))},re=a(408),ce=function(e){var t=e.item,a=Object(c.useContext)(y),n=a.state.reject_task_status_ids,r=a.toggeRejectTaskStatus,s=Object(c.useCallback)(function(e){var t=e.target.value;r(String(t),!e.target.checked)},[r]);return l.a.createElement(Z.a,{check:!0,inline:!0},l.a.createElement(F.a,{check:!0},l.a.createElement(U.a,{onChange:s,type:"checkbox",value:t.id,defaultChecked:!m.a.includes(n,String(t.id))}),t.name))},le=function(){var e=Object(c.useContext)(y),t=e.state,a=t.url,n=t.pid,r=e.setTaskStatus,s=Object(c.useState)([]),u=Object(o.a)(s,2),i=u[0],m=u[1];return Object(c.useEffect)(function(){a&&n&&Object(B.a)(L.a.mark(function e(){var t,c;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get("".concat(j(a),"/task-statuses"),{params:{project:n}});case 2:t=e.sent,c=t.data,m(c),r(c);case 6:case"end":return e.stop()}},e,this)}))()},[a,n]),0===i.length?null:l.a.createElement(h.a,null,l.a.createElement(C.a,null,"Task status"),l.a.createElement(re.a,null,i.map(function(e){return l.a.createElement(ce,{key:e.id,item:e})})))},se=a(158),ue=a.n(se),oe=function(){var e=Object(c.useContext)(y),t=e.state,a=t.url,n=t.isOpen,r=t.mid,s=t.milestones,u=t.biz_days,i=e.setUrl,d=e.openController,E=e.closeController,f=Object(c.useState)(""),p=Object(o.a)(f,2),b=p[0],S=p[1],T=Object(c.useCallback)(function(e){S(e.target.value)},[S]),O=Object(c.useCallback)(function(e){b&&i(b),e.preventDefault()},[b,i]),v=Object(c.useCallback)(function(e){e.stopPropagation()},[]),j=n?90:void 0,g=Object(c.useCallback)(function(){n?E():d()},[d,E,n]),k=function(e,t,a){var n=ee(t,a);return e&&n?"".concat(e,"/project/").concat(n.project_extra_info.slug,"/taskboard/").concat(n.slug):""}(a,r,s);return l.a.createElement(h.a,null,l.a.createElement(C.a,{className:_()(ue.a.header),onClick:g},l.a.createElement(R.a,{rotation:j,icon:w.b}),l.a.createElement(D.a,{color:"primary",pill:!0,className:"p-1 m-1"},l.a.createElement("span",null,function(e,t){return m.a.get(ee(e,t),"name","")}(r,s))),l.a.createElement(D.a,{className:"p-1 m-1"},l.a.createElement("span",null,function(e){return e.length>1?"[".concat(m.a.head(e)," - ").concat(m.a.last(e),"]"):""}(u))),k?l.a.createElement("a",{target:"_blank",onClick:v,className:"float-right",href:k},l.a.createElement(R.a,{className:"mr-1",icon:w.e}),"Taskboard"):null),l.a.createElement(A.a,{isOpen:n},l.a.createElement(x.a,{onSubmit:O},l.a.createElement(I.a,null,l.a.createElement(N.a,{addonType:"prepend"},"URL"),l.a.createElement(U.a,{defaultValue:a,onChange:T,placeholder:"http://hostname:port"}),l.a.createElement(N.a,{addonType:"append"},l.a.createElement(M.a,null,"Set")))),l.a.createElement("div",{className:"row"},l.a.createElement(K,null),l.a.createElement(J,null)),l.a.createElement(V,null),l.a.createElement(ne,null),l.a.createElement(le,null)))},ie=a(419),me=a(420),de=a(414),_e=a(415),Ee=a(156),fe=a(52),pe=a.n(fe),be=a(413),Se=["success","warning","info","danger"],Te=function(e){return m.a.groupBy(e,"assigned_to")},Oe=function(e,t,a){return e.has(t)?(n=m.a.get(e.get(t),"attributes_values.".concat(a),"0"),m.a.chain(n).replace(/[^0-9.+,]/g,"").replace(/[+]/g,",").split(",").compact().map(Number).sum().value()):0;var n},ve=function(e){var t=e.username,a=e.val,n=e.total,r=e.imgSrc;if(!a)return l.a.createElement(l.a.Fragment,null,l.a.createElement("td",null,l.a.createElement("img",{className:pe.a.avator,src:r})," ",t),l.a.createElement("td",null));var c,s,u=(a-n)/n;return u<-.1?(c=w.f,s=""):u<=.1?(s="table-success",c=w.f):u<=.2?(s="table-warning",c=w.g):(s="table-danger",c=w.c),l.a.createElement(l.a.Fragment,null,l.a.createElement("td",{className:s},l.a.createElement("img",{className:pe.a.avator,src:r})," ",t,l.a.createElement(R.a,{className:"mx-1",icon:c})),l.a.createElement("td",{className:_()(s,"text-right")},a))},je=function(e){var t=function(e,t){if(m.a.isNumber(e)&&m.a.isNumber(t)&&e>0){var a=Math.abs(e-t)/e;if(a<=.05)return["gold",3];if(a<=.1)return["silver",2];if(a<.2)return["bronze",1]}return[null,0]}(e.e,e.r),a=Object(o.a)(t,2),n=a[0],r=a[1];return n?l.a.createElement(l.a.Fragment,null,m.a.times(r).map(function(e){return l.a.createElement(R.a,{key:e,className:pe.a[n],icon:w.h})})):null},ge=function(e){var t=e.item,a=e.sums,n=e.isPast,r=e.total,s=e.hpd,u=e.closedTasks,i=Object(c.useContext)(y).state,d=i.custom_value_map,_=i.custom_eid,E=i.reject_task_status_ids,f=i.task_status,p=Object(c.useState)(0),b=Object(o.a)(p,2),S=b[0],T=b[1],v=Object(c.useState)([]),j=Object(o.a)(v,2),g=j[0],k=j[1],h=Object(c.useCallback)(function(e){T(Number(e.target.value)||0)},[T]),C=m.a.get(a,t.id),D=m.a.get(C,"e"),A=m.a.get(C,"r"),x=S||r,I=String(x),N=t.photo||"http://i.pravatar.cc/80?u=".concat(Math.random());return Object(c.useEffect)(function(){var e=m.a.chain(f).filter(function(e){return e.is_closed}).reject(function(e){return m.a.includes(E,String(e.id))}).orderBy("id").reverse().map(function(e){return e.id}).value(),t=m.a.chain(u).groupBy("status").mapValues(function(e){return m.a.reduce(e,function(e,t){return e.status=t.status,e.total+=Oe(d,t,Number(_)),e.label=t.status_extra_info.name,e},{status:0,total:0,label:"",style:""})}).value(),a=m.a.orderBy(t,"status").reverse().map(function(t){return Object(O.a)({},t,{style:Se[e.indexOf(t.status)]})});k(a)},[k,_,d,u,f,E]),l.a.createElement("tr",{key:t.id},r>0?l.a.createElement(l.a.Fragment,null,l.a.createElement(ve,{username:t.username,val:D,total:x,imgSrc:N}),l.a.createElement("td",{className:"text-right"},r),l.a.createElement("td",{className:pe.a.custom_input_td},l.a.createElement(U.a,{bsSize:"sm",type:"number",className:"text-right",value:I,step:s,onChange:h}))):l.a.createElement(l.a.Fragment,null,l.a.createElement("td",null,l.a.createElement("img",{className:pe.a.avator,src:N})," ",l.a.createElement(be.a,{to:"/".concat(t.id)},t.username)),l.a.createElement("td",{className:"text-right"},D),l.a.createElement("td",{className:"text-right"},A),l.a.createElement("td",null,m.a.isNumber(D)&&l.a.createElement(de.a,{multi:!0},g.map(function(e,t){return l.a.createElement(de.a,{bar:!0,key:t,value:e.total,color:e.style,max:D},e.label)})))),n?l.a.createElement("td",null,l.a.createElement(je,{e:D,r:A})):null)},ye=function(e,t){return e.find(function(e){return e.id===t})},ke=function(){var e=Object(c.useContext)(y),t=e.state,a=t.url,n=t.pid,r=t.tasks,s=t.custom_value_map,u=t.custom_attrs,i=t.custom_eid,d=t.custom_rid,_=t.biz_days,E=e.updateData,f=Object(c.useState)([]),p=Object(o.a)(f,2),b=p[0],S=p[1],T=Object(c.useState)(0),O=Object(o.a)(T,2),v=O[0],g=O[1],k=Object(c.useState)(0),h=Object(o.a)(k,2),C=h[0],D=h[1],A=_.length-1;Object(c.useEffect)(function(){a&&n&&Object(B.a)(L.a.mark(function e(){var t,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get("".concat(j(a),"/projects/").concat(n));case 2:t=e.sent,r=t.data.members,S(r);case 5:case"end":return e.stop()}},e,this)}))()},[a,n,S]);var z=Object(c.useCallback)(function(e){g(Number(e.target.value)||0)},[g]),Y=Object(c.useCallback)(function(e){e.preventDefault(),e.stopPropagation()},[]);Object(c.useEffect)(function(){D(v*A)},[v,A,D]);var K=function(e,t,a,n){var r=Number(a),c=Number(n);return m.a.mapValues(Te(e),function(e){return m.a.chain(e).map(function(e){return{e:Oe(t,e,r),r:Oe(t,e,c)}}).reduce(function(e,t){return{e:e.e+t.e,r:e.r+t.r}},{e:0,r:0}).value()})}(r,s,i,d),J=ye(u,Number(i)),V=ye(u,Number(d));if(!J||!V||_.length<=1)return null;var Z=m.a.get(K,"null.e",0),F=C>0,W=!F&&$()().diff($()(m.a.last(_)).local().endOf("days"))>0,q=Te(function(e){return e.filter(function(e){return e.is_closed})}(r));return l.a.createElement(l.a.Fragment,null,l.a.createElement(_e.a,{color:"light",light:!0},l.a.createElement(x.a,{inline:!0,className:"mr-auto",onSubmit:Y},l.a.createElement(I.a,null,l.a.createElement(U.a,{type:"number",step:"0.5",placeholder:"hours / day",className:"text-right",onChange:z}),l.a.createElement(N.a,{addonType:"append"},l.a.createElement(Ee.a,null,l.a.createElement(R.a,{className:"mx-2",icon:w.j}),A," [days]",l.a.createElement(R.a,{className:"mx-2",icon:w.d})),C>0?l.a.createElement(l.a.Fragment,null,l.a.createElement(Ee.a,{className:"bg-white"},l.a.createElement("strong",null,C)),l.a.createElement(Ee.a,null,"hours / sprint")):null))),l.a.createElement(M.a,{onClick:E},l.a.createElement(R.a,{icon:w.i}))),l.a.createElement(G.a,{bordered:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,J.name),F?l.a.createElement(l.a.Fragment,null,l.a.createElement("th",null,"Total")," ",l.a.createElement("th",null,"Custom")):l.a.createElement(l.a.Fragment,null,l.a.createElement("th",null,V.name),l.a.createElement("th",null,"Progress")),W?l.a.createElement("th",null,"Grade"):null)),l.a.createElement("tbody",null,b.map(function(e){return l.a.createElement(ge,{key:e.id,isPast:W,item:e,sums:K,total:C,hpd:v,closedTasks:q[e.id]||[]})}),l.a.createElement("tr",{key:"null"},l.a.createElement("td",null,"unassigned"),l.a.createElement("td",{className:"text-right text-danger"},Z),l.a.createElement("td",null),l.a.createElement("td",null),W?l.a.createElement("td",null):null))))},he=a(416),Ce=a(417),De=function(e){var t=e.url,a=e.item,n=a.project_extra_info.slug,r="".concat(t,"/project/").concat(n,"/task/").concat(a.ref);return l.a.createElement(he.a,{tag:"a",target:"_blank",href:r},l.a.createElement(R.a,{icon:w.e})," ",a.subject)},Ae=function(){var e=Object(c.useContext)(y).state,t=e.url,a=e.tasks,n=e.custom_value_map,r=e.custom_eid,s=Object(c.useState)([]),u=Object(o.a)(s,2),i=u[0],m=u[1];return Object(c.useEffect)(function(){if(a.length>0&&r){var e=Number(r),t=a.filter(function(t){return 0===Oe(n,t,e)});a.length>t.length&&m(t)}},[a,n,r]),0===i.length?null:l.a.createElement(h.a,null,l.a.createElement(C.a,null,"Un estimated tasks"),l.a.createElement(Ce.a,null,i.map(function(e){return l.a.createElement(De,{url:t,key:e.id,item:e})})))},xe=a(39),Ie=function(e,t,a){return m.a.chain(t).map(function(t){return Oe(e,t,Number(a))}).sum().value()},Ne=function(e){var t=e.tasks,a=Object(c.useState)([]),n=Object(o.a)(a,2),r=n[0],s=n[1],u=Object(c.useContext)(y).state,i=u.biz_days,m=u.custom_value_map,d=u.custom_eid;return Object(c.useEffect)(function(){var e=i.length;if(e>0&&t.length>0&&d){var a=Ie(m,function(e,t){return e.filter(function(e){return $()(t).endOf("days").diff($()(e.created_date))>0})}(t,i[0]),d),n=i.map(function(n,r){var c=X(0,r),l=a-a*r/(e-1);return $()().local().endOf("days").diff($()(n))>0?{label:c,estimate:l,result:a-Ie(m,function(e,t){return e.filter(function(e){return!!e.finished_date&&$()(t).local().endOf("days").diff($()(e.finished_date))>0})}(t,n),d),add:0===r?0:Ie(m,function(e,t){return e.filter(function(e){return $()(t).local().format("YYYY-MM-DD")===$()(e.created_date).local().format("YYYY-MM-DD")})}(t,n),d)}:{label:c,estimate:l}});s(n)}else s([])},[t,i,d,m,s]),0===r.length?null:l.a.createElement(h.a,null,l.a.createElement(C.a,null,"Burn down chart"),l.a.createElement(xe.b,{data:r,width:800,height:400},l.a.createElement(xe.f,null),l.a.createElement(xe.e,{dataKey:"label"}),l.a.createElement(xe.d,null),l.a.createElement(xe.a,{dataKey:"result",fill:"#8884d8",stackId:"a"}),l.a.createElement(xe.a,{dataKey:"add",fill:"#82ca9d",stackId:"a"}),l.a.createElement(xe.c,{dataKey:"estimate"})))},Ue=function(){var e=Object(c.useContext)(y).state.tasks;return l.a.createElement(Ne,{tasks:e})},Me=function(){return c.createElement(c.Fragment,null,c.createElement(ke,null),c.createElement(Ae,null),c.createElement(Ue,null))},Re=a(421),we=a(169),ze=a.n(we),Le=function(e){var t=e.url,a=e.item,n=a.user_story_extra_info,r=a.project_extra_info.slug,c=n?"#".concat(n.ref," ").concat(n.subject):void 0,s=n?"".concat(t,"/project/").concat(r,"/us/").concat(n.ref):"#";return c?l.a.createElement("a",{href:s,target:"_blank",title:c},l.a.createElement(R.a,{icon:w.e})," ",c):l.a.createElement(l.a.Fragment,null,"(Unassigned tasks)")},Be=function(e){var t=e.url,a=e.item,n="#".concat(a.ref," ").concat(a.subject),r="".concat(t,"/project/").concat(a.project_extra_info.slug,"/task/").concat(a.ref);return l.a.createElement("a",{href:r,target:"_blank",title:n},l.a.createElement(R.a,{icon:w.e})," ",n)},Ye=function(e){var t=e.userInfo,a=Object(c.useContext)(y).state,n=a.url,r=a.tasks,s=a.custom_attrs,u=a.custom_value_map,i=a.custom_eid,m=a.custom_rid,d=a.biz_days,E=Object(c.useState)([]),f=Object(o.a)(E,2),p=f[0],b=f[1];Object(c.useEffect)(function(){var e=r.filter(function(e){return e.assigned_to===t.id}).sort(function(e,t){return e.user_story-t.user_story});b(e)},[r]);var S=ye(s,Number(i)),T=ye(s,Number(m));if(!S||!T||d.length<=1)return null;var O=0,v=0;return p.forEach(function(e){O+=Oe(u,e,S.id),v+=Oe(u,e,T.id)}),l.a.createElement(G.a,{bordered:!0,size:"sm",className:ze.a.overflow},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"User story"),l.a.createElement("th",null,"Task name"),l.a.createElement("th",null,"Status"),l.a.createElement("th",null,S.name),l.a.createElement("th",null,T.name),l.a.createElement("th",null,"Grade"))),l.a.createElement("tbody",null,p.map(function(e){var t=Oe(u,e,S.id),a=Oe(u,e,T.id);return l.a.createElement("tr",{key:e.id},l.a.createElement("td",{className:e.is_closed?"table-secondary":void 0},l.a.createElement(Le,{url:n,item:e})),l.a.createElement("td",{className:e.is_closed?"table-secondary":void 0},l.a.createElement(Be,{url:n,item:e})),l.a.createElement("td",{className:e.is_closed?"table-secondary":void 0},e.status_extra_info.name),l.a.createElement("td",{className:"text-right"},t),l.a.createElement("td",{className:_()("text-right",a>t?"text-danger":void 0)},a),l.a.createElement("td",null,l.a.createElement(je,{e:t,r:a})))}),l.a.createElement("tr",null,l.a.createElement("td",{colSpan:3},"Total"),l.a.createElement("td",{className:"text-right"},O),l.a.createElement("td",{className:_()("text-right",v>O?"text-danger":void 0)},v),l.a.createElement("td",null,l.a.createElement(je,{e:O,r:v})))))},Pe=a(170),Ke=a.n(Pe),Je=function(e){var t=e.userInfo,a=t.photo||"http://i.pravatar.cc/80?u=".concat(Math.random());return l.a.createElement(h.a,null,l.a.createElement(C.a,null,l.a.createElement("img",{className:Ke.a.avator,src:a})," ".concat(t.username,"'s tasks")))},Ve=function(e){var t=e.userInfo,a=Object(c.useState)([]),n=Object(o.a)(a,2),r=n[0],s=n[1],u=Object(c.useContext)(y).state.tasks;return Object(c.useEffect)(function(){var e=u.filter(function(e){return e.assigned_to===t.id}).sort(function(e,t){return e.user_story-t.user_story});s(e)},[u]),l.a.createElement(Ne,{tasks:r})},Ze=function(e){var t=Object(c.useContext)(y),a=t.state.url,n=t.updateData,r=Object(c.useState)(void 0),l=Object(o.a)(r,2),s=l[0],u=l[1];return Object(c.useEffect)(function(){a&&Object(B.a)(L.a.mark(function t(){var n,r;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.a.get("".concat(j(a),"/users/").concat(e.match.params.uid));case 2:n=t.sent,r=n.data,u(r);case 5:case"end":return t.stop()}},t,this)}))()},[a,u]),c.createElement(c.Fragment,null,c.createElement(_e.a,{color:"light",light:!0},c.createElement(M.a,{tag:be.a,to:"/"},c.createElement(R.a,{icon:w.a})," Go back"),c.createElement(M.a,{onClick:n},c.createElement(R.a,{icon:w.i}))),s?c.createElement(c.Fragment,null,c.createElement(Je,{userInfo:s}),c.createElement(Ye,{userInfo:s}),c.createElement(Ve,{userInfo:s})):c.createElement(Re.a,{color:"danger"},"This user does not exist."))},Fe=function(){return l.a.createElement("div",{className:"container"},l.a.createElement(ie.a,null,l.a.createElement(k,null,l.a.createElement(oe,null),l.a.createElement(me.a,{exact:!0,path:"/",component:Me}),l.a.createElement(me.a,{exact:!0,path:"/:uid",component:Ze}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(l.a.createElement(Fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},52:function(e,t,a){e.exports={gold:"UserTasks_gold__2_Oza",silver:"UserTasks_silver__FUnAn",bronze:"UserTasks_bronze__24R1R",custom_input_td:"UserTasks_custom_input_td__2MdyH",avator:"UserTasks_avator__3C5_y"}}},[[193,1,2]]]);
//# sourceMappingURL=main.37929a47.chunk.js.map